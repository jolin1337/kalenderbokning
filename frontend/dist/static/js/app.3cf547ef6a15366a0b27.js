webpackJsonp([1],{"75Dh":function(t,e){},"7zck":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-app",[e("v-main",[e("router-view")],1)],1)},staticRenderFns:[]};var r=n("VU/8")({name:"App"},i,!1,function(t){n("75Dh")},null,null).exports,a=n("/ocq"),l=n("gRE1"),s=n.n(l),c=n("mvHQ"),u=n.n(c),d=n("mtWM"),v=n.n(d),m={props:{time:Date,booked:Boolean,selected:Boolean,isOwner:Boolean,isAdmin:Boolean},computed:{date:function(){return this.time.toISOString().split("T")[0]},timeStart:function(){var t=this.time.toISOString().split(".")[0].split("T")[1];return t.substring(0,t.length-3)},timeEnd:function(){var t=new Date(this.time.getTime()+18e5).toISOString().split(".")[0].split("T")[1];return t.substring(0,t.length-3)},color:function(){return this.selected?"purple":this.isOwner?"green":this.booked?"grey":"blue"}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-timeline-item",{attrs:{color:t.color+" lighten-1","fill-dot":"",small:!t.selected,right:!t.booked||t.isOwner,left:t.booked&&!t.isOwner}},[n("v-card",{staticClass:"mx-auto",attrs:{color:t.color+" lighten-2"}},[t.booked&&!t.isOwner?n("v-card-title",{staticClass:"title justify-end"},[n("h2",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.date)+"\n          ")]),t._v(" "),n("v-icon",{staticClass:"mr-4",attrs:{dark:"",size:"42"}},[t._v(" mdi-calendar-clock ")]),t._v(" "),n("h3",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.timeStart)+" - "+t._s(t.timeEnd)+"\n          ")])],1):n("v-card-title",{staticClass:"title"},[n("v-icon",{staticClass:"mr-4",attrs:{dark:"",size:"42"}},[t._v(" mdi-calendar-clock ")]),t._v(" "),n("h2",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.date)+"\n          ")]),t._v(" "),n("h3",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.timeStart)+" - "+t._s(t.timeEnd)+"\n          ")]),t._v(" "),n("v-container",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}]},[n("v-row",[n("v-col",[!t.booked&&t.isAdmin?n("v-btn",{staticClass:"mr-4",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.$emit("remove")}}},[t._v("\n                          "+t._s(t.$locale.timeSlot_removeButton)+"\n                      ")]):t._e(),t._v(" "),t.isOwner?n("v-btn",{staticClass:"mr-4",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.$emit("cancel")}}},[t._v("\n                          "+t._s(t.$locale.timeSlot_cancelButton)+"\n                      ")]):n("v-btn",{staticClass:"mr-4",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.$emit("book")}}},[t._v("\n                          "+t._s(t.$locale.timeSlot_bookButton)+"\n                      ")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var f=n("VU/8")(m,h,!1,function(t){n("RsHF")},"data-v-2b666156",null).exports,p={props:{show:{type:Boolean,default:function(){return!0}},alertMsg:String,color:{type:String,default:function(){return"blue"}},title:String}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-overlay",{attrs:{"z-index":10,value:t.show,dark:!1,light:""}},[n("v-card",{staticClass:"mx-auto",attrs:{color:t.color+" lighten-1"}},[n("v-card-title",{staticClass:"title"},[n("h2",{staticClass:"white--text font-weight-light"},[t._v("\n            "+t._s(t.title)+"\n            ")])]),t._v(" "),n("v-card-text",{staticClass:"white text--primary"},[n("v-container",[n("v-row",[n("v-col",[n("br"),t._v(" "),n("h2",{staticClass:"font-weight-light"},[n("p",[t._v(t._s(t.alertMsg))])])])],1),t._v(" "),n("v-row",[n("v-col",[t._t("content")],2)],1),t._v(" "),n("v-row",[n("v-col",[t._t("buttons"),t._v(" "),n("v-btn",{staticClass:"white--text",attrs:{color:"grey"},on:{click:function(e){return t.$emit("close")}}},[t._v("\n                        "+t._s(t.$locale.alert_closeButton)+"\n                        ")])],2)],1)],1)],1)],1)],1)},staticRenderFns:[]},w={components:{TimeSlot:f,Alert:n("VU/8")(p,_,!1,null,null,null).exports},data:function(){return{email:null,isAdmin:!1,errorMsg:"",newSlot:!1,valid:!1,eventsLoaded:!1,eventSlots:[],events:[],activeEvent:""}},computed:{customAttrs:function(){return{email:this.email}},url:function(){var t=window.location.href.split("#")[0].split("?")[0];return t.endsWith("index.php")&&(t=t.replace("index.php","")),t.endsWith("index.html")&&(t=t.replace("index.html","")),t+"api.php"}},methods:{validate:function(t){var e=this;this.$refs.form.validate();var n=this.checkBooked(this.activeEvent);if(this.valid&&(!n||this.email===n.email)){var o=new FormData,i=this.events.find(function(t){return t.email===e.email});i||(i={email:this.email}),i.name="Event for "+this.email,i.start=this.activeEvent.getTime(),i.end=this.activeEvent.getTime()+18e5,o.append("event",u()(i)),o.append("action",t),v.a.post(this.url,o).then(function(t){t.data.error?(e.showAlert=!0,e.errorMsg=e.$locale.home_unableToAddEventError+t.data.error):e.$router.push("/confirm")}).catch(function(t){console.error(t)})}},removeSlot:function(t){var e=this;if(this.isAdmin&&!this.checkBooked(t)){var n=new FormData;n.append("timeslots",u()([t])),n.append("action","removeTimeslots"),v.a.post(this.url,n).then(function(t){t.data.error?(e.showAlert=!0,e.errorMsg=e.$locale.home_unableToRemoveSlotError+t.data.error):e.$router.push("/confirm")})}},addSlot:function(){var t=this;if(this.newSlot.date&&this.newSlot.time&&this.isAdmin){var e=new FormData,n=this.newSlot.date+"T"+this.newSlot.time+":00.000Z";e.append("timeslots",u()([n])),e.append("action","addTimeslots"),v.a.post(this.url,e).then(function(e){t.newSlot=!1,e.data.error?(t.showAlert=!0,t.errorMsg=t.$locale.home_unableToAddSlotError+e.data.error):t.$router.push("/confirm")})}},getEvents:function(t){var e=this,n=t.start,o=t.end;v.a.get(this.url+"?start="+n+"&end="+o+"&action=events").then(function(t){t.data&&(e.events=s()(t.data),e.events.sort(function(t,e){return new Date(t.start)-new Date(e.start)}))})},getEventSlots:function(t){var e=this,n=t.start,o=t.end;return v.a.get(this.url+"/?action=eventslots&start="+n+"&end="+o).then(function(t){t.data&&(e.eventSlots=s()(t.data).map(function(t){return new Date(t)}),e.eventSlots.sort(function(t,e){return t-e}))})},selectTime:function(t){var e=this.checkBooked(t);e&&e.email!==this.email||(this.activeEvent=t)},checkBooked:function(t){var e=new Date(t.getTime()+18e5);return this.events.find(function(n){var o=new Date(n.start);return t<new Date(o.getTime()+18e5)&&e>o})}},mounted:function(){var t=this,e=new Date;e.setHours(1,0,0,0);var n=new Date(e);n.setDate(n.getDate()+7),v.a.get(this.url+"/?action=loggedin").then(function(e){if(t.email=e.data.email,t.isAdmin=e.data.admin,t.eventsLoaded=!0,!1===e.data.loggedin)throw t.$router.push("/login"),Error("Not admin in")}).then(function(){return t.getEventSlots({start:e.toISOString(),end:n.toISOString()})}).then(function(){return t.getEvents({start:e.toISOString(),end:n.toISOString()})}).catch(function(e){console.error(e),t.$router.push("/login")})}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"2"}}),t._v(" "),n("v-col",{attrs:{md:"8"}},[n("h1",[t._v(t._s(t.$locale.home_title))]),t._v(" "),n("v-timeline",{attrs:{dense:t.$vuetify.breakpoint.smAndDown}},[t.isAdmin?n("v-sheet",{on:{click:function(e){t.newSlot={}}}},[n("v-timeline-item",{staticClass:"text-left",attrs:{icon:"mdi-plus",color:"green lighten-0"}},[n("h3",{staticClass:"font-weight-light",staticStyle:{"margin-top":"10px",color:"grey"}},[t._v("\n                "+t._s(t.$locale.home_addNewSlotButton)+"\n              ")])])],1):t._e(),t._v(" "),t._l(t.eventSlots,function(e,o){return n("v-sheet",{key:o,on:{click:function(n){return t.selectTime(e)}}},[n("time-slot",{attrs:{booked:!!t.checkBooked(e),"is-admin":t.isAdmin,"is-owner":(t.checkBooked(e)||{}).email===t.email,selected:t.activeEvent.toString()===e.toString(),time:e},on:{book:function(e){return t.validate("addEvent")},cancel:function(e){return t.validate("deleteEvent")},remove:function(n){return t.removeSlot(e)}}})],1)}),t._v(" "),t.isAdmin?n("v-sheet",{on:{click:function(e){t.newSlot={}}}},[n("v-timeline-item",{staticClass:"text-left",attrs:{icon:"mdi-plus",color:"green lighten-0"}},[n("h3",{staticClass:"font-weight-light",staticStyle:{"margin-top":"10px",color:"grey"}},[t._v("\n                "+t._s(t.$locale.home_addNewSlotButton)+"\n              ")])])],1):t._e()],2)],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"2"}})],1)],1),t._v(" "),n("alert",{attrs:{show:!!t.errorMsg,title:t.$locale.home_errorTitle,color:"red","alert-msg":t.errorMsg},on:{close:function(e){t.errorMsg=""}}}),t._v(" "),t.newSlot?n("alert",{attrs:{color:"blue",title:t.$locale.home_addSlotTitle,"alert-msg":t.$locale.home_addSlotSubTitle},on:{close:function(e){t.newSlot=!1}},scopedSlots:t._u([{key:"content",fn:function(){return[n("v-container",[n("v-row",[n("v-col",[n("v-date-picker",{staticClass:"theme--light",attrs:{color:"green lighten-1",locale:"swe"},model:{value:t.newSlot.date,callback:function(e){t.$set(t.newSlot,"date",e)},expression:"newSlot.date"}})],1),t._v(" "),n("v-col",[n("v-time-picker",{attrs:{color:"green lighten-1","allowed-minutes":function(t){return t%5==0},format:"24hr"},model:{value:t.newSlot.time,callback:function(e){t.$set(t.newSlot,"time",e)},expression:"newSlot.time"}})],1)],1)],1)]},proxy:!0},{key:"buttons",fn:function(){return[n("v-btn",{staticClass:"white--text",attrs:{color:"teal"},on:{click:function(e){return t.addSlot()}}},[t._v("\n      "+t._s(t.$locale.home_addSlotButton)+"\n      ")])]},proxy:!0}],null,!1,966273849)}):t._e()],1)},staticRenderFns:[]};var S=n("VU/8")(w,g,!1,function(t){n("pvuL")},"data-v-3069f025",null).exports,k={data:function(){var t=this;return{valid:!1,email:"",password:"",emailRules:[function(e){return!!e||t.$locale.login_emailRules_emailRequired1},function(e){return/.+@.+/.test(e)||t.$locale.login_emailRules_emailRequired2}],passwordRules:[function(e){return!!e||t.$locale.login_emailRules_passwordRequired}]}},computed:{url:function(){var t=window.location.href.split("#")[0].split("?")[0];return t.endsWith("index.php")&&(t=t.replace("index.php","")),t.endsWith("index.html")&&(t=t.replace("index.html","")),t+"api.php"}},methods:{validate:function(){var t=this;if(this.$refs.form.validate()&&this.valid){var e=new FormData;e.append("email",this.email),e.append("pwd",this.password),e.append("action","login"),v.a.post(this.url,e).then(function(){t.$router.push("/")}).catch(function(t){console.error(t)})}}}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",[n("h1",[t._v(t._s(t.$locale.login_title))]),t._v(" "),n("v-text-field",{attrs:{rules:t.emailRules,counter:30,label:t.$locale.login_email,required:""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),t._v(" "),n("v-row",[n("v-col",[n("v-text-field",{attrs:{type:"password",rules:t.passwordRules,label:t.$locale.login_password,required:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),n("v-row",[n("v-col",[n("v-btn",{staticClass:"mr-4",attrs:{disabled:!t.valid},on:{click:t.validate}},[t._v("\n          "+t._s(t.$locale.login_loginButton)+"\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var $=n("VU/8")(k,b,!1,function(t){n("vs7M")},"data-v-4ac097f9",null).exports,x={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-form",{ref:"form",attrs:{"lazy-validation":""}},[e("v-container",[e("v-row",[e("v-col",[this._v(" "+this._s(this.$locale.confirm_title)+" ")])],1),this._v(" "),e("v-row",[e("v-col",[e("v-btn",{staticClass:"mr-4"},[e("router-link",{attrs:{to:"/"}},[this._v(this._s(this.$locale.confirm_backButton))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var E=n("VU/8")({},x,!1,function(t){n("dwrr")},"data-v-4f8357c3",null).exports;o.default.use(a.a);var C=new a.a({routes:[{path:"/",name:"Home",component:S},{path:"/login",name:"Login",component:$},{path:"/confirm",name:"Confirm",component:E}]}),y=n("3EgV"),D=n.n(y);n("7zck");o.default.use(D.a);var T=new D.a({theme:{dark:!1,themes:{light:{primary:"#3f51b5",secondary:"#b0bec5",accent:"#8c9eff",error:"#b71c1c"}}}}),A={install:function(t,e){t.prototype.$locale=window.defaultLocale}};o.default.config.productionTip=!1,o.default.use(A),new o.default({el:"#app",router:C,vuetify:T,components:{App:r},template:"<App/>"})},RsHF:function(t,e){},dwrr:function(t,e){},pvuL:function(t,e){},vs7M:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.3cf547ef6a15366a0b27.js.map