webpackJsonp([1],{"75Dh":function(t,e){},"7zck":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-app",[e("v-main",[e("router-view")],1)],1)},staticRenderFns:[]};var r=n("VU/8")({name:"App"},a,!1,function(t){n("75Dh")},null,null).exports,o=n("/ocq"),s=n("gRE1"),l=n.n(s),c=n("mvHQ"),v=n.n(c),d=n("mtWM"),u=n.n(d),m={props:{time:Date,booked:Boolean,selected:Boolean,isOwner:Boolean,isAdmin:Boolean},computed:{date:function(){return this.time.toISOString().split("T")[0]},timeStart:function(){var t=this.time.toISOString().split(".")[0].split("T")[1];return t.substring(0,t.length-3)},timeEnd:function(){var t=new Date(this.time.getTime()+18e5).toISOString().split(".")[0].split("T")[1];return t.substring(0,t.length-3)},color:function(){return this.selected?"purple":this.isOwner?"green":this.booked?"grey":"blue"}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-timeline-item",{attrs:{color:t.color+" lighten-1","fill-dot":"",small:!t.selected,right:!t.booked||t.isOwner,left:t.booked&&!t.isOwner}},[n("v-card",{staticClass:"mx-auto",attrs:{color:t.color+" lighten-2"}},[t.booked&&!t.isOwner?n("v-card-title",{staticClass:"title justify-end"},[n("h2",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.date)+"\n          ")]),t._v(" "),n("v-icon",{staticClass:"mr-4",attrs:{dark:"",size:"42"}},[t._v(" mdi-calendar-clock ")]),t._v(" "),n("h3",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.timeStart)+" - "+t._s(t.timeEnd)+"\n          ")])],1):n("v-card-title",{staticClass:"title"},[n("v-icon",{staticClass:"mr-4",attrs:{dark:"",size:"42"}},[t._v(" mdi-calendar-clock ")]),t._v(" "),n("h2",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.date)+"\n          ")]),t._v(" "),n("h3",{staticClass:"white--text font-weight-light"},[t._v("\n              "+t._s(t.timeStart)+" - "+t._s(t.timeEnd)+"\n          ")]),t._v(" "),n("v-container",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}]},[n("v-row",[n("v-col",[!t.booked&&t.isAdmin?n("v-btn",{staticClass:"mr-4",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.$emit("remove")}}},[t._v("\n                          Ta bort\n                      ")]):t._e(),t._v(" "),t.isOwner?n("v-btn",{staticClass:"mr-4",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.$emit("cancel")}}},[t._v("\n                          Avboka\n                      ")]):n("v-btn",{staticClass:"mr-4",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.$emit("book")}}},[t._v("\n                          Boka!\n                      ")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var f=n("VU/8")(m,h,!1,function(t){n("smYg")},"data-v-4ca8ccce",null).exports,p={props:{show:{type:Boolean,default:function(){return!0}},alertMsg:String,color:{type:String,default:function(){return"blue"}},title:String}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-overlay",{attrs:{"z-index":10,value:t.show,dark:!1,light:""}},[n("v-card",{staticClass:"mx-auto",attrs:{color:t.color+" lighten-1"}},[n("v-card-title",{staticClass:"title"},[n("h2",{staticClass:"white--text font-weight-light"},[t._v("\n            "+t._s(t.title)+"\n            ")])]),t._v(" "),n("v-card-text",{staticClass:"white text--primary"},[n("v-container",[n("v-row",[n("v-col",[n("br"),t._v(" "),n("h2",{staticClass:"font-weight-light"},[n("p",[t._v(t._s(t.alertMsg))])])])],1),t._v(" "),n("v-row",[n("v-col",[t._t("content")],2)],1),t._v(" "),n("v-row",[n("v-col",[t._t("buttons"),t._v(" "),n("v-btn",{staticClass:"white--text",attrs:{color:"grey"},on:{click:function(e){return t.$emit("close")}}},[t._v("\n                        Sträng ruta\n                        ")])],2)],1)],1)],1)],1)],1)},staticRenderFns:[]},w={components:{TimeSlot:f,Alert:n("VU/8")(p,g,!1,null,null,null).exports},data:function(){return{email:null,isAdmin:!1,msg:"Välj en tid att boka samtal",errorMsg:"",newSlot:!1,valid:!1,eventsLoaded:!1,eventSlots:[],events:[],activeEvent:""}},computed:{customAttrs:function(){return{email:this.email}},url:function(){var t=window.location.href.split("#")[0].split("?")[0];return t.endsWith("index.php")&&(t=t.replace("index.php","")),t.endsWith("index.html")&&(t=t.replace("index.html","")),t+"api.php"}},methods:{validate:function(t){var e=this;this.$refs.form.validate();var n=this.checkBooked(this.activeEvent);if(this.valid&&(!n||this.email===n.email)){var i=new FormData,a=this.events.find(function(t){return t.email===e.email});a||(a={email:this.email}),a.name="Event for "+this.email,a.start=this.activeEvent.getTime(),a.end=this.activeEvent.getTime()+18e5,i.append("event",v()(a)),i.append("action",t),u.a.post(this.url,i).then(function(t){t.data.error?(e.showAlert=!0,e.errorMsg="Du kunde inte utföra din bokning på denna tiden, anledning: "+t.data.error):e.$router.push("/confirm")}).catch(function(t){console.error(t)})}},removeSlot:function(t){var e=this;if(this.isAdmin&&!this.checkBooked(t)){var n=new FormData;n.append("timeslots",v()([t])),n.append("action","removeTimeslots"),u.a.post(this.url,n).then(function(t){t.data.error?(e.showAlert=!0,e.errorMsg="Du kunde inte utföra borttagning av tiden, anledning: "+t.data.error):e.$router.push("/confirm")})}},addSlot:function(){var t=this;if(this.newSlot.date&&this.newSlot.time&&this.isAdmin){var e=new FormData,n=this.newSlot.date+"T"+this.newSlot.time+":00.000Z";e.append("timeslots",v()([n])),e.append("action","addTimeslots"),u.a.post(this.url,e).then(function(e){t.newSlot=!1,e.data.error?(t.showAlert=!0,t.errorMsg="Du kunde inte lägga till den nya bokningsbara tiden, anledning: "+e.data.error):t.$router.push("/confirm")})}},getEvents:function(t){var e=this,n=t.start,i=t.end;u.a.get(this.url+"?start="+n+"&end="+i+"&action=events").then(function(t){t.data&&(e.events=l()(t.data),e.events.sort(function(t,e){return new Date(t.start)-new Date(e.start)}))})},getEventSlots:function(t){var e=this,n=t.start,i=t.end;return u.a.get(this.url+"/?action=eventslots&start="+n+"&end="+i).then(function(t){t.data&&(e.eventSlots=l()(t.data).map(function(t){return new Date(t)}),e.eventSlots.sort(function(t,e){return t-e}))})},selectTime:function(t){var e=this.checkBooked(t);e&&e.email!==this.email||(this.activeEvent=t)},checkBooked:function(t){var e=new Date(t.getTime()+18e5);return this.events.find(function(n){var i=new Date(n.start);return t<new Date(i.getTime()+18e5)&&e>i})}},mounted:function(){var t=this,e=new Date;e.setHours(1,0,0,0);var n=new Date(e);n.setDate(n.getDate()+7),u.a.get(this.url+"/?action=loggedin").then(function(e){if(t.email=e.data.email,t.isAdmin=e.data.admin,t.eventsLoaded=!0,!1===e.data.loggedin)throw t.$router.push("/login"),Error("Not admin in")}).then(function(){return t.getEventSlots({start:e.toISOString(),end:n.toISOString()})}).then(function(){return t.getEvents({start:e.toISOString(),end:n.toISOString()})}).catch(function(e){console.error(e),t.$router.push("/login")})}},k={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"2"}}),t._v(" "),n("v-col",{attrs:{md:"8"}},[n("h1",[t._v(t._s(t.msg))]),t._v(" "),n("v-timeline",{attrs:{dense:t.$vuetify.breakpoint.smAndDown}},[n("v-sheet",{on:{click:function(e){t.newSlot={}}}},[n("v-timeline-item",{staticClass:"text-left",attrs:{icon:"mdi-plus",color:"green lighten-0"}},[n("h3",{staticClass:"font-weight-light",staticStyle:{"margin-top":"10px",color:"grey"}},[t._v("\n                Lägg till ny tid\n              ")])])],1),t._v(" "),t._l(t.eventSlots,function(e,i){return n("v-sheet",{key:i,on:{click:function(n){return t.selectTime(e)}}},[n("time-slot",{attrs:{booked:!!t.checkBooked(e),"is-admin":t.isAdmin,"is-owner":(t.checkBooked(e)||{}).email===t.email,selected:t.activeEvent.toString()===e.toString(),time:e},on:{book:function(e){return t.validate("addEvent")},cancel:function(e){return t.validate("deleteEvent")},remove:function(n){return t.removeSlot(e)}}})],1)}),t._v(" "),n("v-sheet",{on:{click:function(e){t.newSlot={}}}},[n("v-timeline-item",{staticClass:"text-left",attrs:{icon:"mdi-plus",color:"green lighten-0"}},[n("h3",{staticClass:"font-weight-light",staticStyle:{"margin-top":"10px",color:"grey"}},[t._v("\n                Lägg till ny tid\n              ")])])],1)],2)],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"2"}})],1)],1),t._v(" "),n("alert",{attrs:{show:!!t.errorMsg,title:"Ett fel inträffade",color:"red","alert-msg":t.errorMsg},on:{close:function(e){t.errorMsg=""}}}),t._v(" "),t.newSlot?n("alert",{attrs:{color:"blue",title:"Lägg till ett bokningstillfälle","alert-msg":"Välj tid och datum för det nya bokningstillfället"},on:{close:function(e){t.newSlot=!1}},scopedSlots:t._u([{key:"content",fn:function(){return[n("v-container",[n("v-row",[n("v-col",[n("v-date-picker",{staticClass:"theme--light",attrs:{color:"green lighten-1"},model:{value:t.newSlot.date,callback:function(e){t.$set(t.newSlot,"date",e)},expression:"newSlot.date"}})],1),t._v(" "),n("v-col",[n("v-time-picker",{attrs:{color:"green lighten-1","allowed-minutes":function(t){return t%5==0},format:"24hr"},model:{value:t.newSlot.time,callback:function(e){t.$set(t.newSlot,"time",e)},expression:"newSlot.time"}})],1)],1)],1)]},proxy:!0},{key:"buttons",fn:function(){return[n("v-btn",{staticClass:"white--text",attrs:{color:"teal"},on:{click:function(e){return t.addSlot()}}},[t._v("\n      Lägg till\n      ")])]},proxy:!0}],null,!1,1162184287)}):t._e()],1)},staticRenderFns:[]};var _=n("VU/8")(w,k,!1,function(t){n("spL+")},"data-v-60fc507d",null).exports,S={data:function(){return{msg:"Logga in för att boka samtal",valid:!1,email:"",password:"",emailRules:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+/.test(t)||"E-mail måste vara korrekt"}],passwordRules:[function(t){return!!t||"Lösenord krävs för att logga in"}]}},computed:{url:function(){var t=window.location.href.split("#")[0].split("?")[0];return t.endsWith("index.php")&&(t=t.replace("index.php","")),t.endsWith("index.html")&&(t=t.replace("index.html","")),t+"api.php"}},methods:{validate:function(){var t=this;if(this.$refs.form.validate()&&this.valid){var e=new FormData;e.append("email",this.email),e.append("pwd",this.password),e.append("action","login"),u.a.post(this.url,e).then(function(){t.$router.push("/")}).catch(function(t){console.error(t)})}}}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",[n("h1",[t._v(t._s(t.msg))]),t._v(" "),n("v-text-field",{attrs:{rules:t.emailRules,counter:30,label:"E-post",required:""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),t._v(" "),n("v-row",[n("v-col",[n("v-text-field",{attrs:{type:"password",rules:t.passwordRules,label:"Lösenord",required:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),n("v-row",[n("v-col",[n("v-btn",{staticClass:"mr-4",attrs:{disabled:!t.valid},on:{click:t.validate}},[t._v("\n          Logga in\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var x=n("VU/8")(S,b,!1,function(t){n("scRv")},"data-v-2c9bdb42",null).exports,E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",[t._v(" Din bokning blev godkänd! ")])],1),t._v(" "),n("v-row",[n("v-col",[n("v-btn",{staticClass:"mr-4"},[n("router-link",{attrs:{to:"/"}},[t._v("Tillbaka till kalendern")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var D=n("VU/8")({},E,!1,function(t){n("XS7c")},"data-v-779e8104",null).exports,y={components:{TimeSlot:f},data:function(){return{email:null,msg:"Välj en tid att boka samtal",alert:!1,alertMsg:"",valid:!1,eventsLoaded:!1,eventSlots:[],events:[],activeEvent:""}},computed:{customAttrs:function(){return{email:this.email}},url:function(){var t=window.location.href.split("#")[0].split("?")[0];return t.endsWith("index.php")&&(t=t.replace("index.php","")),t.endsWith("index.html")&&(t=t.replace("index.html","")),t+"api.php"}},methods:{validate:function(t){var e=this;this.$refs.form.validate();var n=this.checkBooked(this.activeEvent);if(this.valid&&(!n||this.email===n.email)){var i=new FormData,a=this.events.find(function(t){return t.email===e.email});a||(a={email:this.email}),a.name="Event for "+this.email,a.start=this.activeEvent.getTime(),a.end=this.activeEvent.getTime()+18e5,i.append("event",v()(a)),i.append("action",t),u.a.post(this.url,i).then(function(t){t.data.error?(e.alert=!0,e.alertMsg="Du kunde inte utföra din bokning på denna tiden, anledning: "+t.data.error):e.$router.push("/confirm")}).catch(function(t){console.error(t)})}},getEvents:function(t){var e=this,n=t.start,i=t.end;u.a.get(this.url+"?start="+n+"&end="+i+"&action=events").then(function(t){t.data&&(e.events=l()(t.data),e.events.sort(function(t,e){return new Date(t.start)-new Date(e.start)}))})},getEventSlots:function(t){var e=this,n=t.start,i=t.end;return u.a.get(this.url+"/?action=eventslots&start="+n+"&end="+i).then(function(t){t.data&&(e.eventSlots=l()(t.data).map(function(t){return new Date(t)}),e.eventSlots.sort(function(t,e){return t-e}))})},selectTime:function(t){var e=this.checkBooked(t);e&&e.email!==this.email||(this.activeEvent=t)},checkBooked:function(t){var e=new Date(t.getTime()+18e5);return this.events.find(function(n){var i=new Date(n.start);return t<new Date(i.getTime()+18e5)&&e>i})}},mounted:function(){var t=this,e=new Date;e.setHours(1,0,0,0);var n=new Date(e);n.setDate(n.getDate()+7),u.a.get(this.url+"/?action=loggedin").then(function(e){if(t.email=e.data.email,t.eventsLoaded=!0,!1===e.data.admin)throw t.$router.push("/login"),Error("Not admin in")}).then(function(){return t.getEventSlots({start:e.toISOString(),end:n.toISOString()})}).then(function(){return t.getEvents({start:e.toISOString(),end:n.toISOString()})}).catch(function(e){console.error(e),t.$router.push("/login")})}},C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"2"}}),t._v(" "),n("v-col",{attrs:{md:"8"}},[n("h1",[t._v(t._s(t.msg))]),t._v(" "),n("v-timeline",{attrs:{dense:t.$vuetify.breakpoint.smAndDown}},t._l(t.eventSlots,function(e,i){return n("v-sheet",{key:i,on:{click:function(n){return t.selectTime(e)}}},[n("time-slot",{attrs:{booked:!!t.checkBooked(e),"is-owner":(t.checkBooked(e)||{}).email===t.email,"is-admin":!0,selected:t.activeEvent.toString()===e.toString(),time:e},on:{book:function(e){return t.validate("addEvent")},cancel:function(e){return t.validate("deleteEvent")}}})],1)}),1)],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"2"}})],1)],1),t._v(" "),n("v-overlay",{attrs:{"z-index":10,value:t.alert}},[n("v-card",{staticClass:"mx-auto",attrs:{color:"red lighten-1"}},[n("v-card-title",{staticClass:"title"},[n("h2",{staticClass:"white--text font-weight-light"},[t._v("Ett fel inträffade")])]),t._v(" "),n("v-card-text",{staticClass:"white text--primary"},[n("br"),t._v(" "),n("h2",{staticClass:"font-weight-light"},[n("p",[t._v(t._s(t.alertMsg))])])]),t._v(" "),n("v-card-text",{staticClass:"white text--primary"},[n("v-btn",{staticClass:"white--text",attrs:{color:"teal"},on:{click:function(e){t.alert=!1}}},[t._v("\n          Sträng ruta\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var $=n("VU/8")(y,C,!1,function(t){n("TRJS")},"data-v-607f27a5",null).exports;i.default.use(o.a);var T=new o.a({routes:[{path:"/",name:"Home",component:_},{path:"/login",name:"Login",component:x},{path:"/confirm",name:"Confirm",component:D},{path:"/admin",name:"Admin",component:$}]}),A=n("3EgV"),O=n.n(A);n("7zck");i.default.use(O.a);var B=new O.a({theme:{dark:!1,themes:{light:{primary:"#3f51b5",secondary:"#b0bec5",accent:"#8c9eff",error:"#b71c1c"}}}});i.default.config.productionTip=!1,new i.default({el:"#app",router:T,vuetify:B,components:{App:r},template:"<App/>"})},TRJS:function(t,e){},XS7c:function(t,e){},scRv:function(t,e){},smYg:function(t,e){},"spL+":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.97424c7bf89529626f79.js.map